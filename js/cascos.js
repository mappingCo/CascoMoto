var baseDeCascos = {
	carretera : {
		arrow : [
			{ref:"casco005", modelo:"Route66", marca: "Bell", peso:1500, caracteristica:"Flow ajust, antiscrash", precio:333, imagen:"img/cascos/casco5.png"},
			{ref:"casco006", modelo:"ArrowBass", marca: "Bell", peso:2000, caracteristica:"Flow Ventilation, anti-scratch", precio:555, imagen:"img/cascos/casco6.png" },
			{ref:"casco007", modelo:"Arrow Pro", marca: "Bell", peso:1300, caracteristica:"Flow Ventilation, anti-scratch", precio:699, imagen:"img/cascos/casco7.png" }
		],
		rootlight : [
			{ref:"casco008", modelo:"Root One", marca: "Bell", peso:1500, caracteristica:"Flow Ventilation", precio:333, imagen:"img/cascos/casco8.png" },
			{ref:"casco009", modelo:"Root Two", marca: "Bell", peso:2000, caracteristica:"Flow Ventilation", precio:555, imagen:"img/cascos/casco9.png" },
			{ref:"casco010", modelo:"Root Mas", marca: "Bell", peso:1300, caracteristica:"Flow Ventilation", precio:699, imagen:"img/cascos/casco10.png" }
		],
		vortex : [
			{ref:"casco011", modelo:"Flack Star", marca: "Bell", peso:1500, caracteristica:"Flow Ventilation", precio:333, imagen:"img/cascos/casco11.png" },
			{ref:"casco012", modelo:"Monarch Tonal", marca: "Bell", peso:2000, caracteristica:"Flow Ventilation", precio:555, imagen:"img/cascos/casco12.png" },
			{ref:"casco013", modelo:"Monarch Pink", marca: "Bell", peso:2000, caracteristica:"Flow Ventilation", precio:555, imagen:"img/cascos/casco13.png" },
			{ref:"casco014", modelo:"Sharp", marca: "Bell", peso:1300, caracteristica:"Flow Ventilation", precio:699, imagen:"img/cascos/casco14.png"}
		]  
	},

	modulares : {
		urban : [
			{ref:"casco015", modelo:"UrbanBass", marca: "casco UrbanBass", peso:1500, caracteristica:"flip-jaw", precio:333, imagen:"img/cascos/casco15.png" },
			{ref:"casco016", modelo:"GM 54S", marca: "Gmax", peso:2000, caracteristica:"flip-jaw", precio:555, imagen:"img/cascos/casco16.png" },
			{ref:"casco017", modelo:"Revolver EVO", marca: "Bell", peso:1300, caracteristica:"flip-jaw, Velocity Flow", precio:699, imagen:"img/cascos/casco17.png" }
		],
		asphalt : [
			{ref:"casco018", modelo:"RT 1000", marca: "ASTONE", peso:1790, caracteristica:"Doble pantalla solar Ventilación por la barbilla, delantera y trasera", precio:133, imagen:"img/cascos/casco18.png" },
			{ref:"casco019", modelo:"Asphalt T", marca: "casco Asphalt T", peso:2000, caracteristica:"Flow Ventilation", precio:555, imagen:"img/cascos/casco16.png" },
			{ref:"casco020", modelo:"Asphalt X", marca: "casco Asphalt X", peso:1300, caracteristica:"Flow Ventilation", precio:699, imagen:"img/cascos/casco17.png" }
		] 
	},

	chica : {
		urbangirl : [
			{ref:"casco021", modelo:"Cat Out'a Hell", marca: "Speed and Strength", peso:1500, caracteristica:"Thermo-Poly Alloy Shell", precio:333, imagen:"img/cascos/casco21.png" },
			{ref:"casco022", modelo:"Pink Ribbon", marca: "Gmax", peso:2000, caracteristica:"flip-jaw", precio:169, imagen:"img/cascos/casco22.png" },
			{ref:"casco023", modelo:"Flower Power", marca: "Speed and Strength", peso:1300, caracteristica:"Flow Ventilation", precio:699, imagen:"img/cascos/casco23.png" },
			{ref:"casco024", modelo:"104-MP-M Matte Pink", marca: "GLX", peso:1500, caracteristica:"lightweight ABS thermoplastic", precio:333, imagen:"img/cascos/casco24.png" },
			{ref:"casco025", modelo:"Urban Bio", marca: "casco Urban Bio", peso:2000, caracteristica:"Flow Ventilation", precio:555, imagen:"img/cascos/casco21.png" },
			{ref:"casco026", modelo:"Urban GTX", marca: "casco Urban GTX", peso:1300, caracteristica:"Flow Ventilation", precio:699, imagen:"img/cascos/casco21.png" },
			{ref:"casco013", modelo:"Monarch Pink", marca: "Bell", peso:2000, caracteristica:"Flow Ventilation", precio:555, imagen:"img/cascos/casco13.png" },
			{ref:"casco028", modelo:"V2+Diva Demi", marca: "Caberg", peso:2000, caracteristica:"Double Visor Tech system", precio:555, imagen:"img/cascos/casco28.png" }
		]
		 
	},

	clasic : {
		openface : [
			{ref:"casco024", modelo:"104-MP-M Matte Pink", marca: "GLX", peso:1500, caracteristica:"lightweight ABS thermoplastic", precio:333, imagen:"img/cascos/casco24.png" },
			{ref:"casco027", modelo:"J-Cruise", marca: "Shoei", peso:1500, caracteristica:"3D Max-Dry, internal sun shield", precio:535, imagen:"img/cascos/casco27.png" },
			{ref:"casco028", modelo:"V2+Diva Demi", marca: "Caberg", peso:2000, caracteristica:"Double Visor Tech system", precio:555, imagen:"img/cascos/casco28.png" },
			{ref:"casco029", modelo:"Mag-9 Sena", marca: "Bell", peso:1200, caracteristica:"Polycarbonate Shel, Sun Shade, Flow Ventilation", precio:180, imagen:"img/cascos/casco29.png" },
			{ref:"casco060", modelo:"Tornado Japan", marca: "Tornado", peso:1600, caracteristica:"Sun Shade, Flow Ventilation", precio:180, imagen:"img/cascos/casco60.png" }
		],
		retro : [
			
			{ref:"casco030", modelo:"ST-Cruz", marca: "Shoei", peso:1000, caracteristica:"Removable (Zip-off) Ear Cover", precio:180, imagen:"img/cascos/casco30.png" },
			{ref:"casco031", modelo:"RJ Platinum-R", marca: "Shoei", peso:950, caracteristica:"Interior desmontable", precio:355, imagen:"img/cascos/casco31.png" },
			{ref:"casco032", modelo:"Cyber", marca: "casco gtx", peso:900, caracteristica:"Contoured visor", precio:699, imagen:"img/cascos/casco32.png" },
			{ref:"casco033", modelo:" Pit Boss", marca: "Bell", peso:900, caracteristica:"Speed Dial fit system", precio:140, imagen:"img/cascos/casco33.png" },
			{ref:"casco034", modelo:"Shorty", marca: "Bell", peso:1050, caracteristica:"Adjustable forehead vents", precio:99, imagen:"img/cascos/casco34.png" },
			{ref:"casco035", modelo:"Nexx X70", marca: "Bell", peso:1050, caracteristica:"CoolMax Inner Lining", precio:199, imagen:"img/cascos/casco35.png" },
			{ref:"casco036", modelo:"Hello Kitty", marca: "Bell", peso:1050, caracteristica:"CoolMax Inner Lining", precio:199, imagen:"img/cascos/casco36.png" },
			{ref:"casco037", modelo:"Bianco 47", marca: "Heritage Helmets", peso:1050, caracteristica:"eco leather lining", precio:199, imagen:"img/cascos/casco37.png" },
			{ref:"casco038", modelo:"Le Mans 20", marca: "Bell", peso:1050, caracteristica:"eco leather lining", precio:799, imagen:"img/cascos/casco38.png" },
			{ref:"casco039", modelo:"Jet R-T", marca: "Bell", peso:1050, caracteristica:"ISDT helmet", precio:799, imagen:"img/cascos/casco39.png" }
		] 
	},

	novelty : {
		biker : [
			{ref:"casco040", modelo:"Clasic Negro", marca: "casco UrbanBass", peso:1500, caracteristica:"free black bandana", precio:99, imagen:"img/cascos/casco40.png" },
			{ref:"casco041", modelo:"NOV_DUCK", marca: "Daytona Helmets", peso:480, caracteristica:"free black bandana", precio:99, imagen:"img/cascos/casco41.png" },
			{ref:"casco042", modelo:"SUPER EAGLE", marca: "Daytona Helmets", peso:1300, caracteristica:"VISOR INCLUDED", precio:99, imagen:"img/cascos/casco42.png" }
		],
		militar : [
			{ref:"casco050", modelo:"Vintage WWII GM 54S", marca: "Harley Davidson", peso:1500, caracteristica:"Piel Artificial", precio:130, imagen:"img/cascos/casco50.png" },
			{ref:"casco051", modelo:"Spikes 118 Flat Bk", marca: "XXX", peso:2000, caracteristica:"Free Head Wrap", precio:75, imagen:"img/cascos/casco51.png" },
			{ref:"casco052", modelo:"Black - German", marca: "XXX", peso:1300, caracteristica:"Free Head Wrap", precio:60, imagen:"img/cascos/casco52.png" }
		] 
	}
};


$(function() {

	CargarCascos(baseDeCascos, 'carretera', 'arrow');
	CargarCascos(baseDeCascos, 'carretera', 'rootlight');
	CargarCascos(baseDeCascos, 'carretera', 'vortex');
	CargarCascos(baseDeCascos, 'modulares', 'urban');
	CargarCascos(baseDeCascos, 'modulares', 'asphalt');
	CargarCascos(baseDeCascos, 'chica', 'urbangirl');
	CargarCascos(baseDeCascos, 'clasic', 'openface');
	CargarCascos(baseDeCascos, 'clasic', 'retro');
	CargarCascos(baseDeCascos, 'novelty', 'biker');
	CargarCascos(baseDeCascos, 'novelty', 'militar');



	//seleccion de la talla de casco dentro del modal:
	$('.badge').click(function(e){
		$('.badge').removeClass('badge-inverse');
		$('.badge').removeClass('badge-important');
		$(this).addClass('badge-important');
	});

	//al pulsar el boton de comprar se añade al carrito

	$('.addCarrito').click(function(e) {
		var modDeCasco=$(this).parent().parent().find('.modal-header').find('h3').html();
		var tallaDeCasco=$(this).parent().parent().find('.badge-important').html();
		var precioCasco=$(this).parent().parent().find('.modal-body').find('ul li.precio').html();

		//alert('Se añaden al carrito: '+modDeCasco +' TALLA: '+ tallaDeCasco +' precio: '+ precioCasco);
		//añade los articulos seleccionados a la lista de compra
		var oldItems = JSON.parse(sessionStorage.getItem('listaCompra')) || [];

		var newItem = {
		    'modelo': modDeCasco,
		    'talla': tallaDeCasco,
		    'precio': precioCasco
		};

		oldItems.push(newItem);

		sessionStorage.setItem('listaCompra', JSON.stringify(oldItems));
		//sumo uno al carrito de la navbar
		var myArray = JSON.parse(sessionStorage.getItem('listaCompra')) || [];
      	var numArticulos=myArray.length;
        $(".navbar").find(".carrito").html('<img src="img/carrito.png" alt="cesta compra" width="30px" /><br/>'+numArticulos+" artículos");
 		
 		//al dar al comprar sale del modal
 		$('#modalTotal').modal('hide');
	});

  	//carga los cascos en cada página y en los modals

	function CargarCascos(cascos, clasificacion, linea){
		var lineaCasco = $('.' + clasificacion + linea + ' .row');

		//convertimos el objeto JSON en objeto JavaScript evaluando la expresion
		var lin = eval('cascos.'+clasificacion+'.'+linea);
	
		//recoremos todo baseDeCascos y vamos rellenado los divs en html
		for (var i = lin.length - 1; i >= 0; i--) {
			
			var casco = $('<div>').addClass('span4');
			var imagen = $('<img>').addClass('cascos').attr('src', lin[i].imagen);
			casco.append(imagen);
			var titulo = $('<h3>').html(lin[i].modelo);
			casco.append(titulo);
			var precio = $('<p>').html('PRECIO: '+ lin[i].precio +' €');
			casco.append(precio);
			var boton = $('<a>').addClass('btn btn-cascomoto').attr('referencia', lin[i].ref);
			boton.attr('clasificacion', clasificacion + '.' + linea);
			boton.attr('role', 'button').html('VER DETALLES &raquo;');
			var parrafoboton = $('<p>').append(boton);
			casco.append(parrafoboton);

			lineaCasco.append(casco);
		};
	}

	$('.btn-cascomoto').click(function(){
		var referencia = $(this).attr('referencia');
		var clasif = $(this).attr('clasificacion');

		// PEDIMOS A LA BASE DE DATOS EL CASCO CON ESA REFERENCIA.
		var cascoBDD = eval('baseDeCascos.' + clasif);
		// Buscar dentro de la categoría
		for (var i = cascoBDD.length - 1; i >= 0; i--) {
			if (cascoBDD[i].ref == referencia)
			{
				cascoBDD = cascoBDD[i];
				break;
			}
		};

		// Rellenamos el diálogo:
		$('#nombreCascoModal').html('MOD: '+cascoBDD.modelo);
		$('#imagenModal').attr('src', cascoBDD.imagen);
		$('#marcaModal').html('Marca: '+cascoBDD.marca);
		$('#pesoModal').html('Peso: '+cascoBDD.peso + ' gr');
		$('#caractModal').html('Con: '+cascoBDD.caracteristica);
		$('#precioModal').html('Precio: '+cascoBDD.precio+ ' €');

		$('#precioCasco').html(cascoBDD.precio);//este solo lo relleno para tener el precio en numero

		$('#modalTotal').modal();
	});
});



